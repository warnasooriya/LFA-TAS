declare @labourcharges Decimal(18,8)declare @PartsPrice Decimal(18,8)declare @SundryPrice Decimal(18,8)declare @claimId2 uniqueidentifierdeclare @totalTax Decimal(18,8)declare @AuthorizedAmount Decimal(18,8) set @claimId2='{claimId}'select		 @labourcharges = SUM(CI.TotalPrice)  FROM [dbo].[ClaimItem] CI  INNER JOIN ClaimItemType CIT ON CIT.Id=CI.ClaimItemTypeId  WHERE CI.ClaimId = @claimId2 AND CIT.ItemCode='L'  select		 @PartsPrice = SUM(CI.TotalPrice)  FROM [dbo].[ClaimItem] CI  INNER JOIN ClaimItemType CIT ON CIT.Id=CI.ClaimItemTypeId  WHERE CI.ClaimId =@claimId2 AND CIT.ItemCode='P'  select		 @SundryPrice = SUM(CI.TotalPrice)  FROM [dbo].[ClaimItem] CI  INNER JOIN ClaimItemType CIT ON CIT.Id=CI.ClaimItemTypeId  WHERE CI.ClaimId =@claimId2 AND CIT.ItemCode='S'  SELECT @totalTax= SUM(CT.Amount) from [dbo].[ClaimTax] CT WHERE ClaimId=@claimId2  SELECT @AuthorizedAmount = AuthorizedAmount from [dbo].[Claim]   WHERE Id=@claimId2SELECT@labourcharges AS Labourtot,@PartsPrice AS Partstot,@SundryPrice AS Sundrytot,@totalTax as TotalTax,@AuthorizedAmount as AuthorizedAmountWithTax,CI.TotalPrice,CIT.ItemCode,PD.DealerName,C.ClaimNumber,DC.CountryName +'-'+DCI.CityName AS CountryCity,CU.FirstName +' '+CU.LastName AS CustomerName,P.BookletNumber,P.PolicyNo,IT.Status,ISNULL(CSub.PlateNo,V.PlateNo) AS PlateNo,V.VINNo,M.MakeName,MO.ModelName,C.FailureDate,C.ClaimMileageKm,CAST(FORMAT(CSub.FailureMileage,'#.00') as NVARCHAR(50)) + ' KM' AS FailureMileage,C.CustomerComplaint,C.DealerComment,C.EngineerComment,UCS.FirstName +' '+UCS.LastName AS ClaimSubmittedUser,UCA.FirstName +' '+UCA.LastName AS ClaimApprovedUser,C.ApprovedDate,C.ClaimDate,C.ConversionRate,C.TotalClaimAmount,C.TotalClaimAmount AS TotalPayable,Pt.PartName,Pt.PartNumber,CI.Id as ClaimId,CI.ParentId,CI.AuthorizedAmount,CI.ConversionRate,CI.DiscountAmount,CI.GoodWillAmount,C.IsApproved,CI.Remark,CI.TotalGrossPrice,CI.AuthorizedAmount,Pt.PartName,CASE WHEN Pt.PartNumber IS NULL	 THEN		(select ItemCode from [dbo].[ClaimItem] where CI.ParentId=Id)	ELSE		 Pt.PartNumber	END AS newPart,PDL.DealerAddressFROM [dbo].[Claim] CINNER JOIN [dbo].[Policy] P on P.Id = C.PolicyIdINNER JOIN [dbo].[ClaimItem] CI on CI.ClaimId = C.IdINNER JOIN [dbo].[Dealer] PD on PD.Id = P.DealerIdINNER JOIN [dbo].[Country] DC on DC.Id = PD.CountryIdINNER JOIN [dbo].[DealerLocation] PDL on PDL.Id = P.DealerLocationIdINNER JOIN [dbo].[City] DCI on DCI.Id = PDL.CityIdINNER JOIN [dbo].[Customer] CU on CU.Id = P.CustomerIdINNER JOIN [dbo].[Make] M on M.Id=C.MakeIdINNER JOIN [dbo].[Model] MO on MO.Id = C.ModelIdINNER JOIN [dbo].[VehiclePolicy] VP ON VP.PolicyId=P.IdINNER JOIN [dbo].[VehicleDetails] V ON V.Id = VP.VehicleIdINNER JOIN [dbo].[ItemStatus] IT ON IT.Id = V.ItemStatusIdINNER JOIN [dbo].[InternalUser] UCS ON UCS.Id = C.ClaimSubmittedByINNER JOIN [dbo].[SystemUser] UCA ON UCA.LoginMapId = C.ApprovedByINNER JOIN [dbo].[Currency] CUR ON CUR.Id = C.ClaimCurrencyIdLEFT JOIN [dbo].[Part] Pt ON CI.PartId=Pt.IdINNER JOIN ClaimItemType CIT ON CIT.Id=CI.ClaimItemTypeIdINNER JOIN ClaimSubmission CSub ON c.ClaimSubmissionId=CSub.idWHERE C.Id = @claimId2GROUP BY TotalPrice,DealerName,C.ClaimNumber,CountryName,DCI.CityName ,CU.FirstName, CU.LastName,P.BookletNumber,P.PolicyNo,IT.Status,ISNULL(CSub.PlateNo,V.PlateNo),V.VINNo,M.MakeName,MO.ModelName,C.FailureDate,C.ClaimMileageKm,CSub.FailureMileage,C.CustomerComplaint,C.DealerComment,C.EngineerComment,UCS.FirstName ,UCS.LastName ,UCA.FirstName ,UCA.LastName ,C.ApprovedDate,C.ClaimDate,C.ConversionRate,C.TotalClaimAmount,C.TotalClaimAmount ,Pt.PartName,Pt.PartNumber,CIT.ItemCode,CI.ParentId,CI.AuthorizedAmount,CI.ConversionRate,CI.DiscountAmount,CI.GoodWillAmount,C.IsApproved,CI.Remark,CI.TotalGrossPrice,CI.TotalPrice,CI.AuthorizedAmount,Pt.PartName,CI.id,PDL.DealerAddress